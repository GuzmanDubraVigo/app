(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))c(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&c(s)}).observe(document,{childList:!0,subtree:!0});function n(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(e){if(e.ep)return;e.ep=!0;const o=n(e);fetch(e.href,o)}})();function m(t){try{const n=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),c=decodeURIComponent(atob(n).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(c)}catch(r){return console.error("Error al decodificar el token JWT:",r),null}}function l(){localStorage.removeItem("userData"),localStorage.removeItem("token")}function i(){window.location.href="http://localhost:4000/app/pages/register"}function p(){const t=localStorage.getItem("userData"),r=localStorage.getItem("token");if(!t||!r){i();return}try{const n=JSON.parse(t),e=m(r).exp*1e3<Date.now(),o=n.role==="admin";(e||!o)&&(l(),i())}catch(n){console.error("Error al verificar permisos del usuario:",n),l(),i()}}p();document.getElementById("logout").addEventListener("click",()=>{localStorage.removeItem("token"),document.location.href="/app/pages/login.html"});const u=2*60*1e3;let d,f;function a(){clearTimeout(d),clearInterval(f);let t=u;f=setInterval(()=>{t-=1e3,g(t)},1e3),d=setTimeout(y,u)}function g(t){const r=document.getElementById("countdown"),n=Math.floor(t/(1e3*60)),c=Math.floor(t%(1e3*60)/1e3);r.textContent=`Close in ${n}:${c<10?"0":""}${c}`}function y(){window.location.href="/pages/login"}document.addEventListener("click",a);document.addEventListener("keydown",a);a();const h=document.getElementsByClassName("reloadButton");for(const t of h)t.addEventListener("click",function(){location.reload()});
